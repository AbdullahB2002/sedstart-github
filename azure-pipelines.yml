trigger: none  # Makes it manual only, like workflow_dispatch. Remove if you want auto-triggers.

pool:
  vmImage: 'ubuntu-latest'

variables:
- group: sedstart-secrets  # Replace with your variable group name if using one
# Or if not using group: - name: SEDSTART_API_KEY_PROD
#   value: $(your-secret-here) but better with group

steps:
- task: Bash@3
  displayName: 'Trigger Sedstart Test Run'
  inputs:
    targetType: 'inline'
    script: |
      curl -X POST "https://api.sedstart.com/run" \
        -H "Authorization: Bearer $(SEDSTART_API_KEY_PROD)" \
        -H "Content-Type: application/json" \
        -d '{
          "project_id": 334,
          "test_id": 2093,
          "profile_id": 406,
          "browser": "chrome",
          "headless": false
        }'
      
      echo "Sedstart test triggered! Check your Sedstart dashboard for results."
  env:
    SEDSTART_API_KEY_PROD: $(SEDSTART_API_KEY_PROD)  # Passes the secret to the task